
# Authentication System with Role-Based Access Control

**Date:** 2025-09-09

---

## ‚úÖ APIs Implemented

---

### 1Ô∏è‚É£ Request OTP  
**POST /api/auth/request-otp**  
Generate OTP and send to email, phone, or WhatsApp.

#### Payload:
```json
{
  "email": "user@example.com",
  "phone": "+919876543210",
  "otpMethod": "email"  // or "phone" or "whatsapp"
}
```

#### Response:
```json
{
  "message": "OTP sent successfully via email"
}
```

---

### 2Ô∏è‚É£ Verify OTP & Signup  
**POST /api/auth/verify-otp-signup**  
Verify OTP and create user.

#### Payload:
```json
{
  "email": "user@example.com",
  "phone": "+919876543210",
  "otpMethod": "email",
  "otp": "123456",
  "username": "john_doe",
  "password": "StrongPassword123"
}
```

#### Response:
```json
{
  "message": "User registered successfully",
  "userId": 1
}
```

---

### 3Ô∏è‚É£ Login  
**POST /api/auth/login**  
Login user and return JWT.

#### Payload:
```json
{
  "email": "user@example.com",
  "password": "StrongPassword123"
}
```

#### Response:
```json
{
  "message": "Login successful",
  "token": "eyJhbGciOiJIUzI1NiIsInR5..."
}
```

---

### 4Ô∏è‚É£ Request Password Reset OTP  
**POST /api/auth/request-password-reset-otp**  
Generate OTP for password reset.

#### Payload:
```json
{
  "email": "user@example.com",
  "phone": "+919876543210",
  "otpMethod": "email"
}
```

#### Response:
```json
{
  "message": "OTP sent successfully for password reset"
}
```

---

### 5Ô∏è‚É£ Reset Password  
**POST /api/auth/reset-password**  
Reset user password after OTP verification.

#### Payload:
```json
{
  "email": "user@example.com",
  "phone": "+919876543210",
  "otpMethod": "email",
  "otp": "123456",
  "newPassword": "NewStrongPassword123"
}
```

#### Response:
```json
{
  "message": "Password reset successfully"
}
```

---

### 6Ô∏è‚É£ Logout  
**POST /api/auth/logout**  
Invalidate user token.

#### Headers:
```http
Authorization: Bearer <jwt-token>
```

#### Response:
```json
{
  "message": "Logout successful"
}
```

---

### ‚ö†Ô∏è Pending to Test Later  
- Promote User Role (`POST /api/admin/promote`)  
- Demote User Role (`POST /api/admin/demote`)

---

## ‚úÖ Top Interview Questions & Best Answers

---

**Q1: Why use JWT in this project?**  
**A1:**  
JWT (JSON Web Token) allows stateless authentication. User info is encoded into the token and sent in headers to access protected routes. It‚Äôs scalable and reduces server-side session storage.

---

**Q2: Why implement OTP flows?**  
**A2:**  
OTP (One-Time Password) is crucial for verifying user‚Äôs contact details during signup and password reset, enhancing security by proving ownership of email or phone.

---

**Q3: Why separate Controllers, Routes, Middlewares?**  
**A3:**  
Separation helps modularity, scalability, and maintainability.  
- Controllers: Business logic  
- Routes: API endpoint definitions  
- Middlewares: Shared logic (authentication, rate limiting)

---

**Q4: What happens when roles change?**  
**A4:**  
Super Admin can promote a user to Admin or demote Admin to User. The change reflects in the DB and impacts JWT payload, controlling access to sensitive routes.

---

**Q5: How do you prevent OTP abuse?**  
**A5:**  
Rate limiting applied (e.g., 3 requests per 10 minutes) prevents spamming and ensures fair usage.

---

## ‚úÖ Next Steps

1. Test Promote/Demote APIs thoroughly.  
2. Integrate real email, SMS, and WhatsApp providers (Nodemailer, Twilio).  
3. Add unit tests using Jest or Mocha.  
4. Deploy system when ready.

---

üöÄ Continue building with purpose and stay curious!